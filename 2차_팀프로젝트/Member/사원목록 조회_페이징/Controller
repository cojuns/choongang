package com.study.springboot.controller;



import com.study.springboot.spring.ListMemberService;
import com.study.springboot.spring.Member;
import com.study.springboot.spring.MemberDao;
import com.study.springboot.spring.MemberPage;
import com.study.springboot.spring.MemberService;

import lombok.extern.slf4j.Slf4j;

import java.util.List;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.jdbc.core.BeanPropertyRowMapper;
import org.springframework.jdbc.core.JdbcTemplate;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestParam;



@Controller
@Slf4j
public class MemberListController {
    @Autowired
	private MemberDao memberDao;

    
   
    
    @GetMapping("/memberList")
    public String listMembers(Model model,
            @RequestParam(defaultValue = "1") int page,
            @RequestParam(defaultValue = "10") int size) {
        int totalMemberCount = memberDao.getTotalMemberCount();
        int totalPages = (int) Math.ceil((double) totalMemberCount / size);

        List<Member> members = memberDao.listAll(page, size);
        model.addAttribute("members", members);
        model.addAttribute("page", page);
        model.addAttribute("size", size);
        model.addAttribute("totalPages", totalPages);

        log.info("Listing members: {}", members);
        System.out.println(members);
        return "/login/memberList"; 
    }

    
    

    


    
    
    

}
